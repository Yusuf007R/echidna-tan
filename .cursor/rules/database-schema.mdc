---
description:
globs:
alwaysApply: true
---
# Database Schema

The application uses Drizzle ORM with the following key tables:

## Tables

### Memories Table
- Stores user memories with embeddings
- Used for semantic search and context retrieval
- Key fields:
  - userId: Links memory to specific user
  - memory: The actual memory content
  - importance: Numerical score for memory importance
  - memoryType: Categorizes the memory
  - embeds: Vector embeddings for semantic search
  - promptTemplate: Associates memory with specific chat context

### Chats Table
- Stores chat conversations
- Links users with their chat history
- Referenced in [bot/src/ai-stuff/structures/memories.ts](mdc:bot/src/ai-stuff/structures/memories.ts)

### Messages Table
- Stores individual chat messages
- Tracks memory processing status
- Key fields:
  - wasMemoryProcessed: Boolean flag for memory extraction

### Users Table
- Stores user information
- Referenced for memory management and chat associations

## Important Notes

- Uses vector similarity search for memory retrieval
- Implements transactions for data consistency
- Tables are interconnected through foreign key relationships